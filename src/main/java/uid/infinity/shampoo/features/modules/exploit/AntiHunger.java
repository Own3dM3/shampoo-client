package uid.infinity.shampoo.features.modules.exploit;

import com.google.common.eventbus.Subscribe;
import uid.infinity.shampoo.event.impl.PacketEvent;
import uid.infinity.shampoo.features.modules.Module;
import uid.infinity.shampoo.mixin.IPlayerMoveC2SPacket;
import net.minecraft.network.packet.c2s.play.ClientCommandC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;

public class AntiHunger extends Module {
    public AntiHunger() {
        super("AntiHunger", "No hunger on servers", Category.EXPLOIT, true,false,false);
    }
    @Subscribe
    public void onPacket(PacketEvent.Send event) {
        if (event.getPacket() instanceof PlayerMoveC2SPacket) {
            IPlayerMoveC2SPacket packet = (IPlayerMoveC2SPacket) event.getPacket();
            packet.setOnGround(mc.player.fallDistance < 0 || mc.interactionManager.isBreakingBlock());
        }
        if (event.getPacket() instanceof ClientCommandC2SPacket) {
            ClientCommandC2SPacket packet = (ClientCommandC2SPacket) event.getPacket();
            if (packet.getMode() == ClientCommandC2SPacket.Mode.START_SPRINTING ||
           packet.getMode() == ClientCommandC2SPacket.Mode.STOP_SPRINTING) {
                event.setCancelled(true);
            }

        }
    }
}